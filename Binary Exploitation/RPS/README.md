# RPS - 200 pts

### Key points

- Strings (`strstr()`)

---

## **Contents**

- [Overview](#overview)
- [Solution](#solution)
- [Flag](#the-flag)

---

## Overview

### Description

> Here's a program that plays rock, paper, scissors against you. I hear something good happens if you win 5 times in a row.

A quick run of the game:

```console
$ nc saturn.picoctf.net 56981
Welcome challenger to the game of Rock, Paper, Scissors
For anyone that beats me 5 times in a row, I will offer up a flag I found
Are you ready?

Please make your selection (rock/paper/scissors):
scissors
scissors
You played: scissors
The computer played: paper
You win! Play again?
...
```

---

## Solution

We need to win 5 times in a row to get the flag. Let's see how the program checks if we have won:

```C
...
char* hands[3] = {"rock", "paper", "scissors"};
char* loses[3] = {"paper", "scissors", "rock"};
...
int computer_turn = rand() % 3;
printf("You played: %s\n", player_turn);
printf("The computer played: %s\n", hands[computer_turn]);

if (strstr(player_turn, loses[computer_turn])) {
    puts("You win! Play again?");
    return true;
} else {
    puts("Seems like you didn't win this time. Play again?");
    return false;
}
```

The computer randomly chooses an element in `hands`. Arrays `hands` and `loses` are defined so that `loses[i]` is the hand that will win against `hands[i]`. The `strstr()` function in the `if` statement checks if the winning hand `loses[computer_turn]` is _present_ in our choice. This means, for example, if the computer plays `'rock'`, and `'paper'` appears _anywhere_ in our input, we will win.

```console
...
Please make your selection (rock/paper/scissors):
aaaaaaaaaaaaaaapaperaaaaaaaaaaaaaa
aaaaaaaaaaaaaaapaperaaaaaaaaaaaaaa
You played: aaaaaaaaaaaaaaapaperaaaaaaaaaaaaaa
The computer played: rock
You win! Play again?
...
```

To guarantee we will win each time, we just need to enter a string that contains all three substrings `'rock'` `'paper'` and `'scissors'`.

It's not hard to do this manually. Here's a script anyways:

```py
from pwn import *

payload = b"rock paper scissors"

r = remote("saturn.picoctf.net", "56981")

for i in range(5):
    r.sendline(b"1")
    r.sendline(payload)

result = r.recvall()
FLAG = result[result.index("pico"):result.index("}") + 1]

print("Flag:", FLAG)
```

---

## Flag

> `picoCTF{50M3_3X7R3M3_1UCK_C85AF58A}`
